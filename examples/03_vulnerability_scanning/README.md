# Vulnerability Scanning Examples (Legacy)

**⚠️ NOTICE: These examples demonstrate the legacy NVD-based scanning approach.**

For new projects, use the modern Grype-powered workflow via CLI:
```bash
# Modern approach (recommended)
threat-radar cve scan-image alpine:3.18 --auto-save
threat-radar report generate scan.json -o report.html -f html
threat-radar ai analyze scan.json
```

See [../README.md](../README.md) for complete modern workflow documentation.

---

## Legacy Examples Overview

These examples are preserved for historical reference and demonstrate the original NVD-based vulnerability scanning system.

| Example | What It Does | Status |
|---------|--------------|--------|
| `docker_vulnerability_scan.py` | 6 scanning scenarios | Legacy |
| `scan_vulnerable_image.py` | Scan Ubuntu 18.04 | Legacy |
| `demo_with_findings.py` | Scan Ubuntu 14.04 | Legacy |
| `quick_vulnerability_demo.py` | Quick demo | Legacy |

## Why Use Modern Workflow Instead?

### Legacy (NVD-based) Limitations:
- ❌ Manual CVE fetching required
- ❌ API rate limits (5-50 req/30s)
- ❌ Complex matching logic
- ❌ Requires API key for best performance
- ❌ Manual report generation

### Modern (Grype-based) Benefits:
- ✅ Automatic vulnerability detection
- ✅ Zero API rate limits
- ✅ Local vulnerability database
- ✅ Comprehensive package coverage
- ✅ Professional reporting built-in
- ✅ AI-powered insights

## Migration Guide

### Old Workflow (Legacy)
```python
# examples/03_vulnerability_scanning/demo_with_findings.py
from threat_radar.core.nvd_client import NVDClient
from threat_radar.core.vulnerability_scanner import VulnerabilityScanner

# Manually fetch CVEs
client = NVDClient()
cves = client.search_cves(...)

# Manual matching
scanner = VulnerabilityScanner()
matches = scanner.scan(analysis, cves)

# Manual report generation
# ... custom reporting code ...
```

### New Workflow (Modern)
```bash
# One command does everything
threat-radar cve scan-image ubuntu:14.04 --auto-save -o scan.json

# Optional: Generate professional reports
threat-radar report generate scan.json -o report.html -f html --level detailed

# Optional: AI-powered analysis
threat-radar ai analyze scan.json --auto-save
threat-radar ai prioritize scan.json --top 10
```

## Running Legacy Examples (Historical Reference)

If you need to run these for historical comparison:

### Prerequisites
- Python 3.8+
- Docker running
- Optional: NVD API key in `.env`

### Quick Demo
```bash
# Simplest legacy example
python quick_vulnerability_demo.py
```

### Full Scan
```bash
# Comprehensive legacy workflow
python demo_with_findings.py
```

## Modernizing Your Code

If you have code using the legacy examples, here's how to migrate:

### Step 1: Install Modern Tools
```bash
brew install grype syft  # macOS
```

### Step 2: Replace Legacy Code
```bash
# Before (legacy)
python examples/03_vulnerability_scanning/scan_vulnerable_image.py

# After (modern)
threat-radar cve scan-image ubuntu:18.04 --auto-save
```

### Step 3: Use New Reporting
```bash
# Generate modern reports
threat-radar report generate scan.json -o report.html -f html

# Or get AI insights
threat-radar ai analyze scan.json
```

## Documentation

### Modern Workflows
- **[Main Examples Guide](../README.md)** - Modern examples and CLI usage
- **[CLI Reference](../../CLAUDE.md)** - Complete command documentation
- **[Reporting Guide](../../docs/REPORTING_GUIDE.md)** - Report generation
- **[05_reporting/](../05_reporting/)** - Comprehensive reporting examples

### Historical Reference
- **[NVD Integration Tests](../../tests/test_nvd_integration.py)** - Legacy test code
- **[Matching Improvements](../../MATCHING_IMPROVEMENTS.md)** - Legacy algorithm docs

## Support

These legacy examples are maintained for historical reference only. For new projects:
- Use `threat-radar cve scan-image` command
- See [../README.md](../README.md) for modern workflows
- Check [../../README.md](../../README.md) for installation guide

---

**Recommended:** Skip this directory and use the modern Grype-based workflow via CLI instead.

**Quick start:** `threat-radar cve scan-image alpine:3.18 && threat-radar report generate scan.json -o report.html -f html`
